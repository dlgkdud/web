<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì§€ë¢°ì°¾ê¸°</title>
    <!-- ê²Œì„ ë³´ë“œ ìŠ¤íƒ€ì¼ -->
    <style>
        .board button {
            width: 30px;
            height: 30px;
            font-size: 16px;
        }

        .flagged {
            background-color: yellow;
            font-weight: bold;
            color: red;
        }

    </style>
</head>
<body>
<!-- ê²Œì„ ë³´ë“œ êµ¬ì„± -->
<div class="board"></div>
</body>
<script>
    const board = document.querySelector('.board');
    const ROWS = 9;
    const COLS = 9;
    const MINES = 10;
    let minePositions = [];
    // ê²Œì„ ì‹œì‘
    initializeGame();

    function initializeGame() {
        initializeBoard();
        placeMines();
    }

    function initializeBoard() {
        board.innerHTML = '';
        for (let i = 0; i < ROWS; i++) {
            let row = document.createElement('div');
            for (let j = 0; j < COLS; j++) {
                let cell = document.createElement('button');
                cell.setAttribute('data-row', i);
                cell.setAttribute('data-col', j);
                cell.addEventListener('click', onCellClick);
                cell.addEventListener('contextmenu', onCellRightClick);
                row.appendChild(cell);
            }
            board.appendChild(row);
        }
    }


    // ì§€ë¢° ìœ„ì¹˜ ëœë¤ ì„¤ì •
    function placeMines() {
        minePositions = [];
        while (minePositions.length < MINES) {
            let position = {
                row: Math.floor(Math.random() * ROWS),
                col: Math.floor(Math.random() * COLS)
            };

            if (!minePositions.some(pos => pos.row === position.row && pos.col === position.col)) {
                minePositions.push(position);
            }
        }
    }

    // ì…€ í´ë¦­ ì´ë²¤íŠ¸
    function onCellClick(event) {
        const row = parseInt(event.target.getAttribute('data-row'));
        const col = parseInt(event.target.getAttribute('data-col'));
        if (isMine(row, col)) {
            alert('í­íƒ„! ê²Œì„ì´ ëë‚¬ìŠµë‹ˆë‹¤.');
            initializeGame();
        } else {
            revealCell(row, col);
        }
    }

    // ì§€ë¢°ì¸ì§€ í™•ì¸
    function isMine(row, col) {
        return minePositions.some(pos => pos.row === row && pos.col === col);
    }

    // ì…€ ì •ë³´ í‘œì‹œ
    function revealCell(row, col) {
        let minesAround = 0;
        for (let i = -1; i <= 1; i++) {
            for (let j = -1; j <= 1; j++) {
                if (i !== 0 || j !== 0) {
                    if (isMine(row + i, col + j)) {
                        minesAround++;
                    }
                }
            }
        }

        const cell = board.children[row].children[col];
        cell.textContent = minesAround > 0 ? minesAround : '';
        cell.disabled = true;
    }


    // ì˜¤ë¥¸ìª½ í´ë¦­(ê¹ƒë°œ ì„¤ì • ë° í•´ì œ)
    function onCellRightClick(event) {
        event.preventDefault(); // ê¸°ë³¸ ì˜¤ë¥¸ìª½ í´ë¦­ ë©”ë‰´ë¥¼ ë‚˜íƒ€ë‚˜ì§€ ì•Šê²Œ í•©ë‹ˆë‹¤.
        const cell = event.target;
        if (cell.disabled) return; // ì´ë¯¸ í´ë¦­ëœ ì…€ì€ ê¹ƒë°œ ì„¤ì •ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

        if (cell.classList.contains('flagged')) {
            cell.classList.remove('flagged');
            cell.textContent = '';
        } else {
            cell.classList.add('flagged');
            cell.textContent = 'ğŸš©';
        }
    }

    function onCellClick(event) {
        const row = parseInt(event.target.getAttribute('data-row'));
        const col = parseInt(event.target.getAttribute('data-col'));
        const cell = event.target;

        if (cell.classList.contains('flagged')) return; // ê¹ƒë°œì´ ìˆëŠ” ì…€ í´ë¦­ì‹œ ì•„ë¬´ëŸ° ì•¡ì…˜ì„ ì·¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

        if (isMine(row, col)) {
            alert('í­íƒ„! ê²Œì„ì´ ëë‚¬ìŠµë‹ˆë‹¤.');
            initializeGame();
        } else {
            revealCell(row, col);
        }
    }

    function onCellClick(event) {
        const row = parseInt(event.target.getAttribute('data-row'));
        const col = parseInt(event.target.getAttribute('data-col'));
        const cell = event.target;

        if (cell.classList.contains('flagged')) return;

        if (isMine(row, col)) {
            revealAllCells(); // ë¨¼ì € ëª¨ë“  ì…€ì˜ ì •ë³´ë¥¼ ê³µê°œí•©ë‹ˆë‹¤.
            setTimeout(() => { // alertë¥¼ setTimeout ë‚´ì— ë„£ì–´ í™”ë©´ ê°±ì‹ ì„ í—ˆìš©í•œ í›„ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                alert('ê²Œì„ì´ ëë‚¬ìŠµë‹ˆë‹¤.');
                initializeGame();
            }, 50);
        } else {
            revealCell(row, col);
        }
    }

    // ëª¨ë“  ì…€ ì •ë³´ í‘œì‹œ
    function revealAllCells() {
        for (let i = 0; i < ROWS; i++) {
            for (let j = 0; j < COLS; j++) {
                const cell = board.children[i].children[j];
                if (isMine(i, j)) {
                    cell.textContent = 'ğŸ’£';
                    cell.style.backgroundColor = 'red';
                } else {
                    const minesAround = countMinesAround(i, j);
                    cell.textContent = minesAround > 0 ? minesAround : '';
                }
                cell.disabled = true;
            }
        }
    }

    // ì£¼ë³€ ì§€ë¢° ìˆ˜ ê³„ì‚°
    function countMinesAround(row, col) {
        let minesAround = 0;
        for (let i = -1; i <= 1; i++) {
            for (let j = -1; j <= 1; j++) {
                if (i !== 0 || j !== 0) {
                    if (isMine(row + i, col + j)) {
                        minesAround++;
                    }
                }
            }
        }
        return minesAround;
    }
</script>